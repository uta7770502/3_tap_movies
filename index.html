<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>æ˜ ç”»æ¤œç´¢ï¼‹ãŠæ°—ã«å…¥ã‚Š</title>
  <style>
    body {
      font-family: sans-serif;
      margin: 0;
      background-color: #fafafa;
    }

    /* ãƒ˜ãƒƒãƒ€ãƒ¼ */
    header {
      background: linear-gradient(90deg, #ff7e5f, #feb47b);
      padding: 15px;
      text-align: center;
      color: white;
      font-size: 20px;
      font-weight: bold;
    }

    /* æ¤œç´¢ã‚¨ãƒªã‚¢ */
    .search-container {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
      margin: 20px auto;
      max-width: 90%;
    }

    #searchInput {
      flex: 1;
      padding: 12px;
      font-size: 16px;
      border: 1px solid #ddd;
      border-radius: 8px;
      outline: none;
    }

    button {
      background: linear-gradient(90deg, #ff7e5f, #feb47b);
      color: white;
      border: none;
      padding: 10px 16px;
      border-radius: 8px;
      font-size: 14px;
      cursor: pointer;
      transition: opacity 0.3s;
    }

    button:hover {
      opacity: 0.8;
    }

    /* çµæœè¡¨ç¤ºã‚«ãƒ¼ãƒ‰ */
    .movie {
      border: 1px solid #ddd;
      border-radius: 12px;
      padding: 12px;
      margin: 15px auto;
      max-width: 600px;
      background: #fff;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      display: flex;
      gap: 15px;
    }

    .movie img {
      width: 100px;
      border-radius: 8px;
    }

    .movie div {
      flex: 1;
    }

    footer {
      margin: 30px;
      text-align: center;
      font-size: 12px;
      color: #666;
    }

    .genre-buttons button, .mood-buttons button {
      margin: 5px;
    }
  </style>
</head>
<body>
  <header>ğŸ¬ æ˜ ç”»æ¤œç´¢ MVP</header>

  <div class="search-container">
    <input id="searchInput" type="text" placeholder="æ˜ ç”»ã‚¿ã‚¤ãƒˆãƒ«ã‚„ä¿³å„ªåã§æ¤œç´¢">
    <button onclick="searchMovies()">æ¤œç´¢</button>
    <button onclick="showFavorites()">â¤ï¸ ãŠæ°—ã«å…¥ã‚Šãƒªã‚¹ãƒˆ</button>
  </div>

  <h2 style="text-align:center; margin-top:30px;">ğŸ­ ã‚¸ãƒ£ãƒ³ãƒ«ã‹ã‚‰æ¢ã™</h2>
  <div class="genre-buttons" style="text-align:center; margin-bottom:20px;">
    <button onclick="searchByGenre(28)">ğŸ’¥ ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</button>
    <button onclick="searchByGenre(35)">ğŸ˜‚ ã‚³ãƒ¡ãƒ‡ã‚£</button>
    <button onclick="searchByGenre(10749)">ğŸ’– æ‹æ„›</button>
    <button onclick="searchByGenre(16)">ğŸ¨ ã‚¢ãƒ‹ãƒ¡</button>
  </div>

  <h2 style="text-align:center; margin-top:30px;">ğŸ˜Š æ°—åˆ†ã§æ¢ã™</h2>
  <div class="mood-buttons" style="text-align:center; margin-bottom:20px;">
    <button onclick="searchByMood('æ³£ããŸã„')">ğŸ˜­ æ³£ããŸã„</button>
    <button onclick="searchByMood('ç¬‘ã„ãŸã„')">ğŸ˜‚ ç¬‘ã„ãŸã„</button>
    <button onclick="searchByMood('ãƒ‰ã‚­ãƒ‰ã‚­')">ğŸ˜± ãƒ‰ã‚­ãƒ‰ã‚­</button>
    <button onclick="searchByMood('ãƒ¯ã‚¯ãƒ¯ã‚¯')">ğŸ¤© ãƒ¯ã‚¯ãƒ¯ã‚¯</button>
  </div>

  <h2 style="text-align:center; margin-top:30px;">ğŸ”¥ ä»Šé€±ã®äººæ°—æ˜ ç”»</h2>
  <div id="trending"></div>

  <h2 style="text-align:center; margin-top:30px;">ğŸ” æ¤œç´¢çµæœ</h2>
  <div id="results"></div>

  <footer>
    <p>This product uses the TMDb API but is not endorsed or certified by TMDb.</p>
  </footer>

  <script>
    const API_KEY = "ã‚ãªãŸã®APIã‚­ãƒ¼";
    let favorites = JSON.parse(localStorage.getItem("favorites")) || [];

    async function searchMovies() {
      const query = document.getElementById("searchInput").value;
      if (!query) {
        alert("æ¤œç´¢ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");
        return;
      }
      const url = `https://api.themoviedb.org/3/search/movie?api_key=${API_KEY}&language=ja&query=${encodeURIComponent(query)}`;
      const res = await fetch(url);
      const data = await res.json();
      displayMovies(data.results);
    }

    function displayMovies(movies) {
      const resultsDiv = document.getElementById("results");
      resultsDiv.innerHTML = "";

      if (movies.length === 0) {
        resultsDiv.innerHTML = "<p>æ¤œç´¢çµæœãŒã‚ã‚Šã¾ã›ã‚“ã€‚</p>";
        return;
      }

      movies.forEach(movie => {
        const div = document.createElement("div");
        div.className = "movie";
        const poster = movie.poster_path
          ? `https://image.tmdb.org/t/p/w200${movie.poster_path}`
          : "https://via.placeholder.com/100x150?text=No+Image";
        div.innerHTML = `
          <img src="${poster}" alt="${movie.title}">
          <div>
            <h3>${movie.title} (${movie.release_date ? movie.release_date.substring(0,4) : "å¹´ä¸æ˜"})</h3>
            <p>${movie.overview ? movie.overview.substring(0, 80) + "..." : "èª¬æ˜ãªã—"}</p>
            <button onclick="addFavorite(${movie.id}, '${movie.title}')">ãŠæ°—ã«å…¥ã‚Šã«è¿½åŠ </button>
          </div>
        `;
        resultsDiv.appendChild(div);
      });
    }

    function addFavorite(id, title) {
      if (!favorites.find(f => f.id === id)) {
        favorites.push({ id, title });
        localStorage.setItem("favorites", JSON.stringify(favorites));
        alert(`${title} ã‚’ãŠæ°—ã«å…¥ã‚Šã«è¿½åŠ ã—ã¾ã—ãŸï¼`);
      } else {
        alert("ã™ã§ã«ãŠæ°—ã«å…¥ã‚Šã«å…¥ã£ã¦ã„ã¾ã™");
      }
    }

    function showFavorites() {
      displayMovies(favorites.map(f => ({ id: f.id, title: f.title, poster_path: null, overview: "" })));
    }

    async function loadTrending() {
      const url = `https://api.themoviedb.org/3/trending/movie/week?api_key=${API_KEY}&language=ja`;
      const res = await fetch(url);
      const data = await res.json();
      displayTrending(data.results);
    }

    function displayTrending(movies) {
      const trendingDiv = document.getElementById("trending");
      trendingDiv.innerHTML = "";
      movies.slice(0, 5).forEach(movie => {
        const div = document.createElement("div");
        div.className = "movie";
        const poster = movie.poster_path
          ? `https://image.tmdb.org/t/p/w200${movie.poster_path}`
          : "https://via.placeholder.com/100x150?text=No+Image";
        div.innerHTML = `
          <img src="${poster}" alt="${movie.title}">
          <div>
            <h3>${movie.title} (${movie.release_date ? movie.release_date.substring(0,4) : "å¹´ä¸æ˜"})</h3>
            <p>${movie.overview ? movie.overview.substring(0, 80) + "..." : "èª¬æ˜ãªã—"}</p>
            <button onclick="addFavorite(${movie.id}, '${movie.title}')">ãŠæ°—ã«å…¥ã‚Šã«è¿½åŠ </button>
          </div>
        `;
        trendingDiv.appendChild(div);
      });
    }

    async function searchByGenre(genreId) {
      const url = `https://api.themoviedb.org/3/discover/movie?api_key=${API_KEY}&with_genres=${genreId}&language=ja&sort_by=popularity.desc`;
      const res = await fetch(url);
      const data = await res.json();
      displayMovies(data.results);
    }

    async function searchByMood(mood) {
      const url = `https://api.themoviedb.org/3/search/keyword?api_key=${API_KEY}&query=${encodeURIComponent(mood)}`;
      const res = await fetch(url);
      const data = await res.json();
      if (data.results.length > 0) {
        const keywordId = data.results[0].id;
        const movieUrl = `https://api.themoviedb.org/3/discover/movie?api_key=${API_KEY}&with_keywords=${keywordId}&language=ja&sort_by=popularity.desc`;
        const movieRes = await fetch(movieUrl);
        const movieData = await movieRes.json();
        displayMovies(movieData.results);
      } else {
        document.getElementById("results").innerHTML = `<p>${mood} æ°—åˆ†ã®æ˜ ç”»ã¯è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚</p>`;
      }
    }

    window.onload = () => {
      loadTrending();
    };
  </script>
</body>
</html>